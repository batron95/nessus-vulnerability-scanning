# Nessus Credentialed Scan Procedure

A credentialed scan allows Nessus to perform more in-depth checks by logging into the target system using valid credentials. This procedure outlines the steps to set up and run a credentialed scan in Nessus.

## Step 1: Prepare Credentials
- **Determine Credentials Needed:**
  - Identify the type of system you will be scanning (e.g., Windows, Linux).
  - Prepare the necessary credentials:
    - **Windows:** Domain or local administrator credentials.
    - **Linux/Unix:** SSH credentials with root or sudo access.
- **Create a Secure Note (Optional):**
  - If you're using sensitive credentials, consider storing them in a secure password manager.

## Step 2: Configure the Scan in Nessus

1. **Log in to Nessus:**
   - Open your browser and navigate to `https://localhost:8834/`.
   - Log in using your Nessus credentials.

2. **Create a New Scan:**
   - Click on **New Scan**.
   - Choose the appropriate scan template, such as **Advanced Scan**.

3. **Enter Basic Scan Information:**
   - Provide a name for the scan (e.g., "Credentialed Scan").
   - Enter a description if necessary.
   - Set the **Target** field to the IP address or hostname of the system(s) you want to scan.

## Step 3: Configure Credentials

1. **Go to the Credentials Tab:**
   - In the scan configuration page, click on the **Credentials** tab.

2. **Add Windows Credentials (if applicable):**
   - Click on **Windows**.
   - Fill in the following fields:
     - **Username:** Domain\username or local administrator username.
     - **Password:** The password for the above user.
     - **Domain:** (Optional) The domain of the Windows network.
   - Optionally, set additional parameters like `SMB signing` and `LM hashes`.

3. **Add SSH Credentials for Linux/Unix (if applicable):**
   - Click on **SSH**.
   - Choose the authentication method:
     - **Password:** Enter the username and password.
     - **Private Key:** Upload the SSH private key file and provide the passphrase if needed.
   - Choose the **Elevate privileges with** method if using a non-root account (e.g., `sudo`).

4. **Additional Credentials:**
   - If you need to scan databases, SNMP devices, or other services, you can add credentials under the corresponding sections (e.g., **Database**, **SNMP**, **Kerberos**, etc.).

## Step 4: Configure Scan Settings

1. **Plugins:**
   - Go to the **Plugins** tab to select or deselect specific plugins based on what you want to scan for.

2. **Advanced Settings (Optional):**
   - Under the **Settings** tab, adjust settings like scan timeout, performance, and port scanning options to match your needs.

3. **Schedule the Scan (Optional):**
   - If you want to run the scan at a specific time or on a recurring basis, go to the **Schedule** tab and set the timing accordingly.

## Step 5: Run the Scan

1. **Save the Scan:**
   - Once all settings are configured, click **Save**.

2. **Start the Scan:**
   - Go to the list of scans, find your newly created scan, and click **Launch** to start the credentialed scan.

## Step 6: Review the Results

1. **Access the Results:**
   - After the scan completes, click on the scan name in the **Completed Scans** section.

2. **Analyze Findings:**
   - Review the vulnerabilities detected. Credentialed scans can reveal issues like missing patches, misconfigurations, and outdated software versions.
   - Pay particular attention to high and critical vulnerabilities.

3. **Export the Report (Optional):**
   - You can export the results in various formats (HTML, PDF, CSV) by clicking on the **Export** button in the scan results page.

## Step 7: Remediation

1. **Apply Patches:**
   - Based on the scan results, apply patches or take other remediation steps to address the vulnerabilities found.

2. **Re-Scan (Optional):**
   - After remediation, consider running another scan to confirm that the vulnerabilities have been resolved.

## Best Practices

- **Use Least Privilege:** Ensure that the credentials provided have the minimum necessary privileges for the scan.
- **Secure Credentials:** Store credentials securely and avoid hardcoding them into scripts or scan configurations.
- **Regular Scanning:** Schedule regular credentialed scans to keep your systems secure and up-to-date.

By following these steps, you can effectively perform a credentialed scan using Nessus, allowing you to identify deeper security vulnerabilities within your systems.
