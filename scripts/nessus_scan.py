import requests

# Nessus API details
NESSUS_URL = 'https://localhost:8834'
API_KEY = 'YOUR_API_KEY'
VERIFY_SSL = False  # Set to True if using a valid SSL certificate

# Function to get the list of scans
def get_scans():
    headers = {
        'X-ApiKeys': f'accessKey={API_KEY};'
    }
    response = requests.get(f'{NESSUS_URL}/scans', headers=headers, verify=VERIFY_SSL)
    
    if response.status_code == 200:
        return response.json()
    else:
        print(f'Error: Unable to retrieve scans. Status Code: {response.status_code}')
        return None

# Example usage
if __name__ == '__main__':
    scans = get_scans()
    if scans:
        print('Available scans:')
        for scan in scans['scans']:
            print(f"- {scan['name']} (ID: {scan['id']})")
